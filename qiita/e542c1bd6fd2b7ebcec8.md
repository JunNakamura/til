---
title: 本番・開発環境の2つ同時にssh接続させないためのアイディア
tags: SSH Linux 運用
author: n_slender
slide: false
---
本番と開発環境の両方にssh接続して、開発の方のターミナルで作業していたつもりが、実は本番でトラブルを起こしてしまった、というのは案外ある話ですね。

片方しか接続できない（or しにくい）ようにできれば、上のようなリスクを軽減できそうです。
単なるアイディアレベルですが、メモを残しておきます。

# 1. 本番・開発サーバには、踏み台サーバを経由しないとSSHログインできないようにする。

iptablesなどのネットワークか、開発・本番サーバのsshd_configで実現できそう。

# 2. 踏み台サーバには、各ユーザは接続数は1までにする

limits.confのmaxloginsで実現できそう。

# 3. 踏み台サーバにsshログインしたら、本番・開発のどちらかにsshログインするか、そのままログアウトを強制する

sshd_configのForceCommandで実現できそう。

これならいけそうな気がする。サーバ側の設定だけで済みそう。

環境を用意するのが手間がかかって、検証できそうにないですが。




